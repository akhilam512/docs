---
title: "UserIdleProcessor"
description: "A processor that monitors user inactivity and triggers callbacks after specified timeout periods"
---

The `UserIdleProcessor` is a specialized frame processor that monitors user activity in a conversation and executes callbacks when the user becomes idle. It's particularly useful for maintaining engagement by detecting periods of user inactivity.

## Constructor Parameters

<ParamField path="callback" type="Callable" required>
  An async function that will be called when user inactivity is detected. The
  function should accept the processor instance as its argument.
</ParamField>

<ParamField path="timeout" type="float" required>
  The number of seconds to wait before considering the user idle.
</ParamField>

## Behavior

The processor starts monitoring for inactivity only after the first conversation activity (either `UserStartedSpeakingFrame` or `BotSpeakingFrame`). It manages idle state based on the following rules:

- Resets idle timer when user starts or stops speaking
- Pauses idle monitoring while user is speaking
- Resets idle timer when bot is speaking
- Stops monitoring on conversation end or cancellation

## Example Implementation

Here's a complete example showing how to use the UserIdleProcessor in a pipeline:

```python
async def user_idle_callback(user_idle: UserIdleProcessor):
    messages.append({
        "role": "system",
        "content": "Ask the user if they are still there and try to prompt for some input."
    })
    await user_idle.push_frame(LLMMessagesFrame(messages))

# Create the processor
user_idle = UserIdleProcessor(
    callback=user_idle_callback,
    timeout=5.0
)

# Add to pipeline
pipeline = Pipeline([
    transport.input(),
    user_idle,  # Add the processor to monitor user activity
    context_aggregator.user(),
    # ... rest of pipeline
])
```

## Frame Handling

The processor handles the following frame types:

- `UserStartedSpeakingFrame`: Marks user as active and resets idle timer
- `UserStoppedSpeakingFrame`: Starts idle monitoring
- `BotSpeakingFrame`: Resets idle timer
- `EndFrame` / `CancelFrame`: Stops idle monitoring

## Notes

- The idle callback won't be triggered while the user or bot is actively speaking
- The processor automatically cleans up its resources when the pipeline ends
