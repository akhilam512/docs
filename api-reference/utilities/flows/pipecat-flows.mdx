---
title: 'Pipecat Flows'
description: 'Technical reference for Pipecatâ€™s conversation flow system'
---

<Tip>
  New to building conversational flows? Check out our [Pipecat Flows
  guide](/guides/pipecat-flows) first.
</Tip>

## Installation

Pipecat Flows requires an additional dependency:

```bash
pip install "pipecat-ai[flows]"
```

## FlowManager

Main class for managing conversation flows.

### Constructor Parameters

<ParamField path="flow_config" type="dict" required>
  Complete flow configuration including initial_node and nodes
</ParamField>

<ParamField path="task" type="PipelineTask" required>
  Pipeline task for frame queueing
</ParamField>

<ParamField path="tts_service" type="TTSService">
  Optional TTS service for immediate speech actions
</ParamField>

### Configuration Structure

<ResponseField name="flow_config" type="Object">
  <Expandable title="properties">
    <ResponseField name="initial_node" type="string" required>
      The starting node identifier for the conversation flow
    </ResponseField>

    <ResponseField name="nodes" type="Object" required>
      <Expandable title="properties">
        <ResponseField name="[node_name]" type="Node Object">
          Each key is a node name that can be referenced by function calls

          <Expandable title="properties">
            <ResponseField name="messages" type="Array" required>
              List of messages that set the LLM context. Format depends on the LLM service being used.
              For OpenAI, each message requires 'role' and 'content'.
            </ResponseField>

            <ResponseField name="functions" type="Array" required>
              List of available functions for this node. Format depends on the LLM service being used.
              For OpenAI, each function requires 'type', 'function' object with name, description, and parameters.

              Note: Function names must match node names to enable transitions.
            </ResponseField>

            <ResponseField name="pre_actions" type="Array">
              Optional actions to execute before LLM context update

              <Expandable title="properties">
                <ResponseField name="type" type="string" required>
                  Action type (e.g., "tts_say")
                </ResponseField>
                <ResponseField name="[parameters]" type="Any">
                  Action-specific parameters
                </ResponseField>
              </Expandable>
            </ResponseField>

            <ResponseField name="post_actions" type="Array">
              Optional actions to execute after LLM context update

              <Expandable title="properties">
                <ResponseField name="type" type="string" required>
                  Action type (e.g., "end_conversation")
                </ResponseField>
                <ResponseField name="[parameters]" type="Any">
                  Action-specific parameters
                </ResponseField>
              </Expandable>
            </ResponseField>
          </Expandable>
        </ResponseField>
      </Expandable>
    </ResponseField>

  </Expandable>
</ResponseField>

### Example flow_config

Here's a minimal example demonstrating the `flow_config` structure:

```python
flow_config = {
    "initial_node": "start",
    "nodes": {
        "start": {
            "messages": [
                {
                    "role": "system",
                    "content": "Ask if user wants option A or B"
                }
            ],
            "functions": [
                {
                    "type": "function",
                    "function": {
                        "name": "choose_a",  # Transitions to choose_a node
                        "description": "User chooses option A",
                        "parameters": {"type": "object", "properties": {}}
                    }
                }
            ]
        },
        "choose_a": {
            "messages": [
                {
                    "role": "system",
                    "content": "Handle option A selection"
                }
            ],
            "functions": [
                {
                    "type": "function",
                    "function": {
                        "name": "select_value",  # Terminal function (stays in node)
                        "description": "Select a value",
                        "parameters": {
                            "type": "object",
                            "properties": {
                                "value": {"type": "string"}
                            }
                        }
                    }
                }
            ],
            "pre_actions": [
                {
                    "type": "tts_say",
                    "text": "Processing option A..."
                }
            ],
            "post_actions": [
                {
                    "type": "end_conversation",
                    "text": "All done!"
                }
            ]
        }
    }
}
```

<Note>
  See the [Pipecat Flows guide](/guides/pipecat-flows) for a more complete
  example.
</Note>

### Methods

<ParamField path="initialize" type="async method">
Initialize the flow with starting messages

Parameters:

- initial_messages: List[dict] - Initial context messages

</ParamField>

<ParamField path="register_functions" type="async method">
Register flow functions with LLM service

Parameters:

- llm_service: LLMService - Service to register functions with

</ParamField>

<ParamField path="register_action" type="method">
Register custom action handler

Parameters:

- action_type: str - Action identifier
- handler: Callable - Action handler function

</ParamField>

## Built-in Actions

<ParamField path="tts_say" type="action">
  Speaks text immediately using TTS service
  <Expandable title="parameters">
    <ResponseField name="text" type="string" required>
      Text to be spoken
    </ResponseField>
  </Expandable>
</ParamField>

<ParamField path="end_conversation" type="action">
  Ends the conversation and closes the connection
  <Expandable title="parameters">
    <ResponseField name="text" type="string">
      Optional farewell message to speak before ending
    </ResponseField>
  </Expandable>
</ParamField>

### Example Usage

```python
# Pre-action with immediate TTS
"pre_actions": [
    {
        "type": "tts_say",
        "text": "Processing your request..."
    }
]

# Post-action to end conversation
"post_actions": [
    {
        "type": "end_conversation",
        "text": "Thank you for using our service. Goodbye!"
    }
]
```

## Function Types

### Terminal Functions

Execute without changing nodes. Used for refinement within a state.

### Transitional Functions

Execute and change to new node. Used for major state changes.
